/**
 * @file Firestore Security Rules
 * @version 2
 *
 * @Core Philosophy:
 * This ruleset is in prototyping mode.
 * It prioritizes ease of access, and allows access to all users.
 *
 * @Data Structure:
 * - /users/{userId}: Stores user data, accessible by any user.
 * - /orders/{orderId}: Stores order data, accessible by any user.
 * - /inventory/{inventoryId}: Stores inventory data, accessible by any user.
 *
 * @Key Security Decisions:
 * - All data is accessible to all authenticated users for prototyping purposes.
 * - Data validation is minimal, focusing on relational integrity where feasible.
 * - In the absence of specific ownership fields, write rules are permissive for prototyping, but should be restricted in production with ownership checks.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows any authenticated user to read and write user data.
     * @path /users/{userId}
     * @allow (get, list, create, update, delete) - Any authenticated user.
     * @deny (none) - All users are allowed.
     * @principle Allows read and write access to any authenticated user for prototyping.
     */
    match /users/{userId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows any authenticated user to read and write order data.
     * @path /orders/{orderId}
     * @allow (get, list, create, update, delete) - Any authenticated user.
     * @deny (none) - All users are allowed.
     * @principle Allows read and write access to any authenticated user for prototyping.
     */
    match /orders/{orderId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Allows any authenticated user to read and write inventory data.
     * @path /inventory/{inventoryId}
     * @allow (get, list, create, update, delete) - Any authenticated user.
     * @deny (none) - All users are allowed.
     * @principle Allows read and write access to any authenticated user for prototyping.
     */
    match /inventory/{inventoryId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    // Helper function to determine if a user is signed in.
    function isSignedIn() {
      return request.auth != null;
    }
  }
}